/*
 constellation.js | http://constellationjs.com/license */
function f(a){throw a;}var q=!0,s=null,t=!1;function u(){return function(){}}function w(a){return function(){return this[a]}}Node=function(a,b){this.id=a;this.data=b?b:{};this.edges=[]};window.Node=Node;Node.prototype.Ba=function(){for(var a=[],b=0;b<this.edges.length;b++)this.edges[b].tailNode.id==this.id?a.push(this.edges[b].headNode):a.push(this.edges[b].tailNode);return a};Node.prototype.getNeighborNodes=Node.prototype.Ba;
Node.prototype.Cb=function(){for(var a=[],b=0;b<this.edges.length;b++)this.edges[b].tailNode.id==this.id?a.push([this.edges[b],this.edges[b].headNode]):a.push([this.edges[b],this.edges[b].tailNode]);return a};Node.prototype.getNeighborEdgeNodePairs=Node.prototype.Cb;Node.prototype.t=function(){jQuery(this).trigger("dataChange")};Node.prototype.dataChanged=Node.prototype.t;Edge=function(a,b,c,d){this.id=a;this.tailNode=b;this.headNode=c;this.data=d?d:{}};window.Edge=Edge;
Edge.prototype.Db=function(a){return a==this.tailNode.id?this.headNode:a==this.headNode.id?this.tailNode:s};Edge.prototype.getOtherNode=Edge.prototype.Db;Edge.prototype.t=function(){jQuery(this).trigger("dataChange")};Edge.prototype.dataChanged=Edge.prototype.t;Graph=function(){this.f=[];this.e=[]};window.Graph=Graph;Graph.prototype.I=function(a,b){this.k(a)&&f("Failed to add node. Node already exists. id="+a);var c=new Node(a,b);this.f.push(c);return c};Graph.prototype.addNode=Graph.prototype.I;
Graph.prototype.k=function(a){for(var b=0;b<this.f.length;b++)if(this.f[b].id==a)return this.f[b];return s};Graph.prototype.getNode=Graph.prototype.k;Graph.prototype.S=function(){return this.f.concat()};Graph.prototype.getNodes=Graph.prototype.S;Graph.prototype.ba=function(){return this.f.map(function(a){return a.id})};Graph.prototype.getNodeIds=Graph.prototype.ba;Graph.prototype.Da=function(){return this.f.length};Graph.prototype.getNodeLength=Graph.prototype.Da;
Graph.prototype.removeNode=function(a){for(var b=0;b<this.f.length;b++)if(this.f[b].id==a){for(;0<this.f[b].edges.length;)this.U(this.f[b].edges[0].id);this.f.splice(b,1);return}f("Failed to remove node. Node does not exist. id="+a)};Graph.prototype.removeNode=Graph.prototype.removeNode;Graph.prototype.Ra=function(a,b){var c=this.k(a);c?c.data=b:f("Failed to update node. Node does not exist. id="+a);return c};Graph.prototype.updateNode=Graph.prototype.Ra;
Graph.prototype.Ta=function(a,b,c,d){var c=2<arguments.length?c:t,d=3<arguments.length?d:t,e=this.k(a);e?e.data=c?jQuery.extend(d,e.data,b):b:e=this.I(a,b);return e};Graph.prototype.upsertNode=Graph.prototype.Ta;
Graph.prototype.H=function(a,b,c,d){this.A(a)&&f("Failed to add edge. Edge already exists. id="+a);var e=this.k(b);e||f("Failed to add edge. Tail node does not exist. id="+b);(b=this.k(c))||f("Failed to add edge. Head node does not exist. id="+c);a=new Edge(a,e,b,d);this.e.push(a);e.edges.push(a);b.edges.push(a);return a};Graph.prototype.addEdge=Graph.prototype.H;Graph.prototype.A=function(a){for(var b=0;b<this.e.length;b++)if(this.e[b].id==a)return this.e[b];return s};Graph.prototype.getEdge=Graph.prototype.A;
Graph.prototype.aa=function(){return this.e.map(function(a){return a.id})};Graph.prototype.getEdgeIds=Graph.prototype.aa;Graph.prototype.oa=function(){return this.e.concat()};Graph.prototype.getEdges=Graph.prototype.oa;Graph.prototype.Aa=function(){return this.e.length};Graph.prototype.getEdgeLength=Graph.prototype.Aa;
Graph.prototype.U=function(a){var b,c=s;for(b=0;b<this.e.length;b++)if(this.e[b].id==a){c=this.e[b];this.e.splice(b,1);break}if(c){for(b=0;b<c.tailNode.edges.length;b++)if(c.tailNode.edges[b].id==a){c.tailNode.edges.splice(b,1);break}for(b=0;b<c.headNode.edges.length;b++)if(c.headNode.edges[b].id==a){c.headNode.edges.splice(b,1);break}}else f("Failed to remove edge. Edge does not exist. id="+a)};Graph.prototype.removeEdge=Graph.prototype.U;
Graph.prototype.Qa=function(a,b){var c=this.A(a);c?c.data=b:f("Failed to update edge. Edge does not exist. id="+a);return c};Graph.prototype.updateEdge=Graph.prototype.Qa;Graph.prototype.Sa=function(a,b,c,d,e,i){var e=4<arguments.length?e:t,i=5<arguments.length?i:t,g=this.A(a);g?g.data=e?jQuery.extend(i,g.data,d):d:g=this.H(a,b,c,d);return g};Graph.prototype.upsertEdge=Graph.prototype.Sa;GraphLoader=function(a){0>=arguments.length||(this.config=a,this.parser=this.constellation=s)};
window.GraphLoader=GraphLoader;GraphLoader.prototype.$=w("constellation");GraphLoader.prototype.getConstellation=GraphLoader.prototype.$;GraphLoader.prototype.j=function(a){this.constellation=a};GraphLoader.prototype.setConstellation=GraphLoader.prototype.j;GraphLoader.prototype.Eb=w("parser");GraphLoader.prototype.getParser=GraphLoader.prototype.Eb;GraphLoader.prototype.Rb=function(a){this.parser=a};GraphLoader.prototype.setParser=GraphLoader.prototype.Rb;
SimpleGraphLoader=function(a){0>=arguments.length||GraphLoader.call(this,a)};window.SimpleGraphLoader=SimpleGraphLoader;SimpleGraphLoader.prototype=new GraphLoader;SimpleGraphLoader.prototype.j=function(a){this.constellation&&jQuery(this.constellation).unbind("initialized");GraphLoader.prototype.j.call(this,a);this.constellation&&jQuery(this.constellation).bind("initialized",{context:this},function(a){a=a.data.context;a.config.url&&a.load(a.config.url)})};
SimpleGraphLoader.prototype.setConstellation=SimpleGraphLoader.prototype.j;SimpleGraphLoader.prototype.load=function(a){this.parser||f("Graph loading halted. No parser has been set.");jQuery.ajax({url:a,context:this,success:function(a){this.parser.parse(a)}})};SimpleGraphLoader.prototype.load=SimpleGraphLoader.prototype.load;TreeGraphLoader=function(a){0>=arguments.length||GraphLoader.call(this,a)};window.TreeGraphLoader=TreeGraphLoader;TreeGraphLoader.prototype=new GraphLoader;
TreeGraphLoader.prototype.j=function(a){GraphLoader.prototype.j.call(this,a);jQuery(this.constellation).bind("nodeselected",u())};GraphParser=function(a){0>=arguments.length||(this.config=a,this.graph=s)};window.GraphParser=GraphParser;GraphParser.prototype.wb=w("graph");GraphParser.prototype.getGraph=GraphParser.prototype.wb;GraphParser.prototype.Ob=function(a){this.graph=a};GraphParser.prototype.setGraph=GraphParser.prototype.Ob;GraphParser.prototype.parse=u();GraphParser.prototype.parse=GraphParser.prototype.parse;
JsonGraphParser=function(a){0>=arguments.length||(a.separator||(a.separator="~~"),GraphParser.call(this,a))};window.JsonGraphParser=JsonGraphParser;JsonGraphParser.prototype=new GraphParser;JsonGraphParser.prototype.parse=function(a){"string"==typeof a&&(a=jQuery.parseJSON(a));var b=this.graph,c=this.config.separator;jQuery.each(a.nodes,function(a,c){b.I(c.id,c.data)});jQuery.each(a.edges,function(a,e){b.H(e.id?e.id:e.source+c+e.target,e.source,e.target,e.data)});jQuery(this).trigger("complete")};
JsonGraphParser.prototype.parse=JsonGraphParser.prototype.parse;RoamerGraphParser=function(a){0>=arguments.length||GraphParser.call(this,a)};window.RoamerGraphParser=RoamerGraphParser;RoamerGraphParser.prototype=new GraphParser;
RoamerGraphParser.prototype.parse=function(a){a instanceof jQuery||(a=jQuery(a));var b=this.graph;a.find("node").each(function(a,d){var d=jQuery(d),e={};jQuery.each(this.attributes,function(a,b){e[b.name]=b.value});b.I(d.attr("id"),e)});a.find("edge").each(function(a,d){var d=jQuery(d),e={};jQuery.each(this.attributes,function(a,b){e[b.name]=b.value});b.H(d.attr("id"),d.attr("tail_node_id"),d.attr("head_node_id"),e)});jQuery(this).trigger("complete")};RoamerGraphParser.prototype.parse=RoamerGraphParser.prototype.parse;
GraphMlParser=function(a){0>=arguments.length||GraphParser.call(this,a)};window.GraphMlParser=GraphMlParser;GraphMlParser.prototype=new GraphParser;
GraphMlParser.prototype.parse=function(a){a instanceof jQuery||(a=jQuery(a));var b=this.graph,c={};a.find('key[for="node"]').each(function(a,b){b=jQuery(b);c[b.attr("id")]=b});var d={};a.find('key[for="edge"]').each(function(a,b){b=jQuery(b);d[b.attr("id")]=b});a.find("node").each(function(a,d){var d=jQuery(d),g={},h;for(h in c){var j=c[h].attr("attr.name").replace(/[^a-zA-Z0-9]/g,"_"),o=d.find('data[key="'+h+'"]');0<o.length&&(g[j]=o.text())}b.I(d.attr("id"),g)});a.find("edge").each(function(a,c){var c=
jQuery(c),g={},h;for(h in d){var j=d[h].attr("attr.name").replace(/[^a-zA-Z0-9]/g,"_"),o=c.find('data[key="'+h+'"]');0<o.length&&(g[j]=o.text())}b.H(c.attr("source")+":"+c.attr("target"),c.attr("source"),c.attr("target"),g)});jQuery(this).trigger("complete")};GraphMlParser.prototype.parse=GraphMlParser.prototype.parse;GraphView=function(a){0>=arguments.length||(this.config=a,this.result=this.source=this.constellation=s,this.Ua=q)};window.GraphView=GraphView;GraphView.prototype.$=w("constellation");
GraphView.prototype.getConstellation=GraphView.prototype.$;GraphView.prototype.j=function(a){this.constellation=a;this.T()};GraphView.prototype.setConstellation=GraphView.prototype.j;GraphView.prototype.Hb=w("source");GraphView.prototype.getSource=GraphView.prototype.Hb;GraphView.prototype.Wb=function(a){this.source=a;this.T()};GraphView.prototype.setSource=GraphView.prototype.Wb;GraphView.prototype.mb=function(){this.T()};GraphView.prototype.sourceChanged=GraphView.prototype.mb;
GraphView.prototype.Fb=w("result");GraphView.prototype.getResult=GraphView.prototype.Fb;GraphView.prototype.Sb=function(a){this.result=a;this.T()};GraphView.prototype.setResult=GraphView.prototype.Sb;GraphView.prototype.T=function(){if(this.Ua){this.Ua=t;var a=this;window.setTimeout(function(){if(a.constellation&&a.source&&a.result){var b=a.validate();a.Ua=q;b&&jQuery(a).trigger("change")}},50)}};GraphView.prototype.invalidate=GraphView.prototype.T;GraphView.prototype.la=function(){return t};
GraphView.prototype.validate=GraphView.prototype.la;DirectGraphView=function(a){0>=arguments.length||GraphView.call(this,a)};window.DirectGraphView=DirectGraphView;DirectGraphView.prototype=new GraphView;
DirectGraphView.prototype.la=function(){var a,b=this.result.ba(),c=this.result.aa(),d=this.source.S(),e=this.source.oa();for(a=0;a<e.length;a++)index=c.indexOf(e[a].id),0<=index&&(edge=this.result.A(e[a].id),edge.data=e[a].data,c.splice(index,1),e.splice(a,1),a--);for(a=0;a<d.length;a++)index=b.indexOf(d[a].id),0<=index&&(node=this.result.k(d[a].id),node.data=d[a].data,b.splice(index,1),d.splice(a,1),a--);for(a=0;a<c.length;a++)this.result.U(c[a]);for(a=0;a<b.length;a++)this.result.removeNode(b[a]);
for(a=0;a<d.length;a++)b=d[a],this.result.I(b.id,b.data);for(a=0;a<e.length;a++)d=e[a],this.result.H(d.id,d.tailNode.id,d.headNode.id,d.data);return q};DirectGraphView.prototype.validate=DirectGraphView.prototype.la;TreeGraphView=function(a){0>=arguments.length||(GraphView.call(this,a),this.u=s,this.ta=t,this.na=1)};window.TreeGraphView=TreeGraphView;TreeGraphView.prototype=new GraphView;
TreeGraphView.prototype.j=function(a){this.constellation&&jQuery(this.constellation).unbind("nodeselect");GraphView.prototype.j.call(this,a);this.constellation&&(a=this.u,this.u=this.constellation.Ga(),this.ta=this.u!=a,jQuery(this.constellation).bind("nodeselect",{context:this},function(a){a.data.context.gb()}))};TreeGraphView.prototype.setConstellation=TreeGraphView.prototype.j;TreeGraphView.prototype.gb=function(){this.ta=q;this.u=this.constellation.Ga();this.T()};
TreeGraphView.prototype.selectedNodeHandler=TreeGraphView.prototype.gb;
TreeGraphView.prototype.la=function(){var a,b,c=this.config.startDepth?this.config.startDepth:2,d=this.config.depth?this.config.depth:3,e=this.config.delay?this.config.delay:1E3;this.ta&&(this.na=c);if(a=this.source.k(this.u)){a.data.depth=0;var i=this.result.ba(),g=this.result.aa(),h=[a],c=[];b={};var j=[a];for(b[this.u]={X:this.na,ra:0};0<j.length;){var o=j.shift(),k=b[o.id];if(0<k.X){var m=o.edges;for(a=0;a<m.length;a++){var l=m[a],n;n=l.tailNode.id==o.id?l.headNode:l.tailNode;var p=b[n.id];if((!p||
p.X<k.X-1)&&1<k.X)p=k.X-1,n.data.depth=k.ra+1,h.push(n),j.push(n),p={X:p,ra:k.ra+1},b[n.id]=p;0>jQuery.inArray(l,c)&&p&&(l.data.depth=k.ra,c.push(l))}}}for(a=0;a<c.length;a++)b=g.indexOf(c[a].id),0<=b&&(l=this.result.A(c[a].id),l.data=c[a].data,l.t(),g.splice(b,1),c.splice(a,1),a--);for(a=0;a<h.length;a++)b=i.indexOf(h[a].id),0<=b&&(node=this.result.k(h[a].id),node.data=h[a].data,node.t(),i.splice(b,1),h.splice(a,1),a--);for(a=0;a<g.length;a++)b=g[a],jQuery(this.source.k(b)).unbind("dataChange",this.Xb),
this.result.U(b);for(a=0;a<i.length;a++)g=i[a],jQuery(this.source.k(g)).unbind("dataChange",this.Zb),this.result.removeNode(g);for(a=0;a<h.length;a++)i=h[a],g=this.result.I(i.id,jQuery.extend({},i.data)),jQuery(i).bind("dataChange",{context:this,result:g},this.Xa);for(a=0;a<c.length;a++)h=c[a],i=this.result.H(h.id,h.tailNode.id,h.headNode.id,jQuery.extend({},h.data)),jQuery(h).bind("dataChange",{context:this,result:i},this.Xa);this.ta=t;if(this.na<d){clearTimeout(this.Ib);var r=this;this.Ib=setTimeout(function(){r.na++;
r.T()},e)}return q}};TreeGraphView.prototype.validate=TreeGraphView.prototype.la;TreeGraphView.prototype.Xa=function(a){a.data.result.data=a.target.data;a.data.result.q()};Layout=function(a){0>=arguments.length||(this.config=a)};window.Layout=Layout;Layout.prototype.$=w("constellation");Layout.prototype.getConstellation=Layout.prototype.$;Layout.prototype.j=function(a){this.constellation=a};Layout.prototype.setConstellation=Layout.prototype.j;
Layout.prototype.N=function(){for(var a=this.constellation.S(),b=0;b<a.length;b++){var c=a[b];if(c.x==s||c.y==s)c.x=10*Math.floor((100*Math.random()-50)/10),c.y=10*Math.floor((100*Math.random()-50)/10)}jQuery(this).trigger("change")};Layout.prototype.viewChanged=Layout.prototype.N;StaticLayout=function(a){0>=arguments.length||(Layout.call(this,a),this.p=s)};window.StaticLayout=StaticLayout;StaticLayout.prototype=new Layout;
StaticLayout.prototype.j=function(a){this.constellation&&jQuery(this.constellation).unbind("nodemousedown").unbind("nodemouseup").unbind("mouseup").unbind("nodetouchstart").unbind("nodetouchend").unbind("touchend");Layout.prototype.j.call(this,a);this.constellation&&jQuery(this.constellation).bind("nodemousedown",{context:this},function(a){a.data.context.ha(a)}).bind("nodemouseup mouseup",{context:this},function(a){a.data.context.fa(a)}).bind("nodetouchstart",{context:this},function(a){a.data.context.ia(a)}).bind("nodetouchend touchend",
{context:this},function(a){a.data.context.Pa(a)})};StaticLayout.prototype.setConstellation=StaticLayout.prototype.j;StaticLayout.prototype.N=function(){for(var a=this.constellation.S(),b=0;b<a.length;b++){var c=a[b];if(c.x==s||c.y==s)c.x=isNaN(c.data.x)?(Math.random()-0.5)*this.constellation.R:Number(c.data.x),c.y=isNaN(c.data.y)?(Math.random()-0.5)*this.constellation.O:Number(c.data.y)}jQuery(this).trigger("change")};StaticLayout.prototype.viewChanged=StaticLayout.prototype.N;
StaticLayout.prototype.ha=function(){this.step()};StaticLayout.prototype.fa=function(){this.p&&clearInterval(this.p)};StaticLayout.prototype.ia=function(){this.step()};StaticLayout.prototype.Pa=function(){this.p&&clearInterval(this.p)};
StaticLayout.prototype.step=function(){for(var a in this.constellation.h){var b=this.constellation.h[a];if(b.ga){var c=b.i,d=b.ga,e=this.constellation.F(c.pageX)-b.Ma,b=this.constellation.G(0,c.pageY)-b.Na;d.x=this.constellation.P(e,b);d.y=this.constellation.Q(e,b)}}jQuery(this).trigger("change");this.p&&clearTimeout(this.p);this.p=setTimeout(function(a){return function(){a.step()}}(this),40)};
RoamerLayout=function(a){0>=arguments.length||(Layout.call(this,a),this.p=s,this.sa=t,this.ka=0,this.ya=150,this.Wa=100,this.va=[])};window.RoamerLayout=RoamerLayout;RoamerLayout.prototype=new Layout;
RoamerLayout.prototype.j=function(a){this.constellation&&(jQuery(this.constellation).unbind("nodeAdded"),this.p&&clearTimeout(this.p));Layout.prototype.j.call(this,a);this.constellation&&(jQuery(this.constellation).bind("nodeAdded",{context:this},function(a,c){a.data.context.va.push(c)}).bind("nodemousedown",{context:this},function(a,c){a.data.context.ha(a,c)}).bind("nodetouchstart",{context:this},function(a,c){a.data.context.ia(a,c)}).bind("viewportchange",{context:this},function(a){a=a.data.context;
a.start();a.viewport=a.constellation.Ha()}),this.viewport=this.constellation.Ha(),this.start())};RoamerLayout.prototype.setConstellation=RoamerLayout.prototype.j;RoamerLayout.prototype.N=function(){this.start()};RoamerLayout.prototype.viewChanged=RoamerLayout.prototype.N;RoamerLayout.prototype.ha=function(){this.start()};RoamerLayout.prototype.ia=function(){this.start()};RoamerLayout.prototype.start=function(){this.ka=0;this.sa||(this.sa=q,this.step())};
RoamerLayout.prototype.stop=function(){this.p&&clearTimeout(this.p);this.sa=t};
RoamerLayout.prototype.step=function(){var a=this.config,b=a.scrollRate!=s?a.scrollRate:0.1,c=a.baseEdgeLength!=s?a.baseEdgeLength:100,d=a.attractionFactor!=s?a.attractionFactor:0.2,e=a.repulsionFactor!=s?a.repulsionFactor:0.2,i=a.accelerationLimit!=s?a.accelerationLimit:15,g=a.dampingConstant!=s?a.dampingConstant:0.3,h=a.bounded,a=this.ka<this.ya?1:this.ka<this.ya+this.Wa?1-(this.ka-this.ya)/this.Wa:0;0<this.va.length&&(this.setNodeInitialPositions(this.va),this.va=[]);for(var j=this.constellation.ab(),
o=-b*(j.x+j.width/2),b=-b*(j.y+j.height/2),j=this.constellation.S(),k=0;k<j.length;k++)for(var m=j[k],l=k+1;l<j.length;l++){var n=j[l],p=n.x-m.x,r=n.y-m.y;0==p&&0==r&&(p=0.5*Math.random(),r=0.5*Math.random());for(var v=Math.sqrt(p*p+r*r),x=c,D=p-p/v*x,E=r-r/v*x,p=r=0,F=t,B=0;B<m.edges.length;B++){var G=m.edges[B];if(G.tailNode.id==n.id||G.headNode.id==n.id)F=q}F&&v>x?(r=D*d*a,p=E*d*a):v<x&&(r=D*e*a,p=E*e*a);v=1;x=m.edges.length;0<x&&(v=1/Math.pow(x,1/3));m.ax+=r*v;m.ay+=p*v;v=1;x=n.edges.length;0<
x&&(v=1/Math.pow(x,1/3));n.ax-=r*v;n.ay-=p*v}for(k=0;k<j.length;k++)c=j[k],d=Math.sqrt(c.ax*c.ax+c.ay*c.ay),d>i&&(c.ax=c.ax/d*i,c.ay=c.ay/d*i),c.ax-=c.vx*g,c.ay-=c.vy*g,c.vx+=c.ax,c.vy+=c.ay,c.x+=c.vx+o,c.y+=c.vy+b,h&&"none"!=jQuery(c.M()).css("display")&&(d=c.M().getBBox(),c.x-d.width/2<this.viewport.x&&(c.x=this.viewport.x+d.width/2,c.vx*=-1),c.y-d.height/2<this.viewport.y&&(c.y=this.viewport.y+d.height/2,c.vy*=-1),c.x+d.width/2>this.viewport.x+this.viewport.width&&(c.x=this.viewport.x-d.width/
2+this.viewport.width,c.vx*=-1),c.y+d.height/2>this.viewport.y+this.viewport.height&&(c.y=this.viewport.y-d.height/2+this.viewport.height,c.vy*=-1)),c.ax=0,c.ay=0;for(var I in this.constellation.h)h=this.constellation.h[I],h.ga&&(o=h.i,i=h.ga,g=this.constellation.F(o.pageX)-h.Ma,h=this.constellation.G(0,o.pageY)-h.Na,i.x=this.constellation.P(g,h),i.y=this.constellation.Q(g,h));jQuery(this).trigger("change");0==a?this.stop():this.sa&&(this.p&&clearTimeout(this.p),this.p=setTimeout(function(a){return function(){a.step()}}(this),
40));this.ka++};RoamerLayout.prototype.Qb=function(a){for(var b=0;b<a.length;b++)this.setNodeInitialPosition(a[b])};RoamerLayout.prototype.setNodeInitialPositions=RoamerLayout.prototype.Qb;
RoamerLayout.prototype.Pb=function(a){var b=0,c=0,d=a.Ba().filter(this.Za),e=y(d);1<d.length?(b=e.x,c=e.y):0<d.length&&(c=d[0],b=c.Ba().filter(this.Za),0<b.length?(b=y(b),d={x:c.x-b.x,y:c.y-b.y},e=Math.sqrt(d.x*d.x+d.y*d.y),b=c.x+50*d.x/e,c=c.y+50*d.y/e):(b=c.x,c=c.y));a.x=b+Math.random()-0.5;a.y=c+Math.random()-0.5};RoamerLayout.prototype.setNodeInitialPosition=RoamerLayout.prototype.Pb;RoamerLayout.prototype.Za=function(a){return a.x!=s||a.y!=s};
function y(a){if(0>=a.length)return s;for(var b=0,c=0,d=0;d<a.length;d++)var e=a[d],b=b+e.x,c=c+e.y;return{x:b/a.length,y:c/a.length}}NodeRenderer=function(a,b,c){this.constellation=a;this.classes=[];Node.call(this,b,c);this.t();this.y=this.x=s;this.ay=this.ax=this.vy=this.vx=0};window.NodeRenderer=NodeRenderer;NodeRenderer.prototype=new Node;NodeRenderer.prototype.defaultStyles={};NodeRenderer.prototype.c=function(a){return this.constellation.c("node",this.classes,a,this.data,this.defaultStyles)};
NodeRenderer.prototype.getStyle=NodeRenderer.prototype.c;NodeRenderer.prototype.addClass=function(a){0>jQuery.inArray(a,this.classes)&&this.classes.push(a)};NodeRenderer.prototype.addClass=NodeRenderer.prototype.addClass;NodeRenderer.prototype.hasClass=function(a){return 0<=jQuery.inArray(a,this.classes)};NodeRenderer.prototype.hasClass=NodeRenderer.prototype.hasClass;NodeRenderer.prototype.removeClass=function(a){for(var b;0<=(b=jQuery.inArray(a,this.classes));)this.classes.splice(b,1)};
NodeRenderer.prototype.removeClass=NodeRenderer.prototype.removeClass;NodeRenderer.prototype.t=function(){Node.prototype.t.call(this);if(this.data["class"]){this.classes=[];for(var a=this.data["class"].split(/\s/),b=0;b<a.length;b++)this.addClass(a[b])}};NodeRenderer.prototype.dataChanged=NodeRenderer.prototype.t;NodeRenderer.prototype.create=u();NodeRenderer.prototype.create=NodeRenderer.prototype.create;NodeRenderer.prototype.q=u();NodeRenderer.prototype.draw=NodeRenderer.prototype.q;
NodeRenderer.prototype.position=u();NodeRenderer.prototype.position=NodeRenderer.prototype.position;NodeRenderer.prototype.J=u();NodeRenderer.prototype.destroy=NodeRenderer.prototype.J;NodeRenderer.prototype.M=u();NodeRenderer.prototype.getSvg=NodeRenderer.prototype.M;DefaultNodeRenderer=function(a,b,c){NodeRenderer.call(this,a,b,c);this.Oa=this.Ka=this.cb=this.bb=this.L=this.label=s};window.DefaultNodeRenderer=DefaultNodeRenderer;DefaultNodeRenderer.prototype=new NodeRenderer;
DefaultNodeRenderer.prototype.defaultStyles={label:"",tooltip:"",cursor:"default",graphicShape:"circle",graphicFillColor:"#ffffff",graphicLineColor:"#000000",graphicSize:40,leftIconUrl:s,leftIconWidth:16,leftIconHeight:16,rightIconUrl:s,rightIconWidth:16,rightIconHeight:16,leftIconSpacing:0,rightIconSpacing:0,labelBoxEnabled:q,labelBoxFillColor:"#ffffff",labelBoxLineColor:"#000000",labelBoxCornerRadius:5,labelPosition:"center",labelFontColor:"#000000",labelFontWeight:"normal",labelFontFamily:"Arial",
labelFontStyle:"normal",labelFontSize:12};
DefaultNodeRenderer.prototype.create=function(){var a=this.constellation.svg,b=a.group(this.constellation.Ca(),{display:"none"});this.a={group:b,Ia:a.group(b),D:s,Ja:a.rect(b,0,0,0,0,2,2,{preserveAspectRatio:"none",fill:"#ffffcc",stroke:"#333333",strokeWidth:1}),label:a.text(b,0,0,"",{style:"-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;-o-user-select: none;user-select: none;",fontFamily:"Verdana",fontSize:15,fontWeight:"bold",fill:"#441111",textAnchor:"middle",
dy:".35em"}),da:s,ja:s,L:a.title(b,"")};jQuery(this.a.group).bind("mouseover",{context:this},function(a){a.data.context.constellation.nodemouseoverHandler(a,a.data.context)}).bind("mouseout",{context:this},function(a){a.data.context.constellation.nodemouseoutHandler(a,a.data.context)}).bind("mousedown",{context:this},function(a){a.data.context.constellation.nodemousedownHandler(a,a.data.context)}).bind("mouseup",{context:this},function(a){a.data.context.constellation.nodemouseupHandler(a,a.data.context)}).bind("touchstart",
{context:this},function(a){a.data.context.constellation.nodetouchstartHandler(a,a.data.context)}).bind("touchend",{context:this},function(a){a.data.context.constellation.nodetouchendHandler(a,a.data.context)})};DefaultNodeRenderer.prototype.create=DefaultNodeRenderer.prototype.create;
DefaultNodeRenderer.prototype.q=function(){var a=this.constellation.svg;jQuery(this.a.group).css("display","inline");var b={fill:this.c("graphicFillColor"),stroke:this.c("graphicLineColor")},c=this.c("label"),d=this.c("tooltip"),e=this.c("graphicSize"),i=this.c("graphicShape");if(this.bb!=i)switch(this.a.D&&(jQuery(this.a.D).remove(),this.a.D=s),i){case "pentagon":break;case "square":this.a.D=a.rect(this.a.Ia,-e/2,-e/2,e,e,b);break;case "diamond":break;case "triangle":break;case "circle":this.a.D=
a.circle(this.a.Ia,0,0,e/2,b);break;default:f("Failed to draw node graphic. Unknown shape. shape='"+i+"'")}else{if(this.cb!=e)switch(i){case "pentagon":break;case "square":b.x=-e/2;b.y=-e/2;b.width=e;b.height=e;break;case "diamond":break;case "triangle":break;case "circle":b.r=e/2;break;default:f("Failed to draw node graphic. Unknown shape. shape='"+i+"'")}a.change(this.a.D,b)}this.label!=c&&jQuery(this.a.label).contents().remove().end().append(c);a.change(this.a.label,{fontFamily:this.c("labelFontFamily"),
fontSize:this.c("labelFontSize"),fontStyle:this.c("labelFontStyle"),fontWeight:this.c("labelFontWeight"),fill:this.c("labelFontColor")});var g=this.a.D?this.a.D.getBBox():{width:0,height:0},b=this.a.label.getBBox(),h=this.c("leftIconUrl");""==h&&(h=s);var j={width:this.c("leftIconWidth"),height:this.c("leftIconHeight")},o=this.c("rightIconUrl");""==o&&(o=s);var k={width:this.c("rightIconWidth"),height:this.c("rightIconHeight")},m=(h?j.width+5:0)+b.width+(o?5+k.width:0),l=Math.max(h?j.height:0,b.height,
o?k.height:0),n;switch(this.c("labelPosition")){case "top":n=-m/2;g=-g.height/2-5-3-l;break;case "right":n=g.width/2+13;g=-l/2;break;case "bottom":n=-m/2;g=g.height/2+8;break;case "left":n=-g.width/2-5-8-m;g=-l/2;break;default:this.constellation.error("Unexpected value for node labelPosition property. value="+this.c("labelPosition"));case "center":n=-m/2,g=-l/2}var p=n+(h?j.width+5:0),r=g+(l-b.height)/2;if(this.c("labelBoxEnabled")&&0<b.width&&0<b.height){var v=this.c("labelBoxCornerRadius");jQuery(this.a.Ja).css("display",
"inline").attr("x",n-8).attr("y",g-3).attr("width",m+16).attr("height",l+6).attr("rx",v).attr("ry",v);a.change(this.a.Ja,{fill:this.c("labelBoxFillColor"),stroke:this.c("labelBoxLineColor")})}else jQuery(this.a.Ja).css("display","none");a.change(this.a.label,{x:p+b.width/2,y:r+b.height/2});j.x=n;j.y=g+(l-j.height)/2;h!=this.Ka?this.Ka==s?this.a.da=a.image(this.a.group,j.x,j.y,j.width,j.height,h):h==s?(a.remove(this.a.da),this.a.da=s):a.change(this.a.da,jQuery.extend(j,{"xlink:href":h})):a.change(this.a.da,
j);k.x=n+m-k.width;k.y=g+(l-k.height)/2;o!=this.Oa?this.Oa==s?this.a.ja=a.image(this.a.group,k.x,k.y,k.width,k.height,o):o==s?(a.remove(this.a.ja),this.a.ja=s):a.change(this.a.ja,jQuery.extend(k,{"xlink:href":o})):a.change(this.a.ja,k);this.L!=d&&jQuery(this.a.L).contents().remove().end().append(d);jQuery(this.a.group).css("cursor",this.c("cursor"));this.position();this.label=c;this.L=d;this.cb=e;this.bb=i;this.Ka=h;this.Oa=o};DefaultNodeRenderer.prototype.draw=DefaultNodeRenderer.prototype.q;
DefaultNodeRenderer.prototype.position=function(){this.x!=s&&this.y!=s&&jQuery(this.a.group).attr("transform","translate("+this.x+","+this.y+")rotate("+180*-this.constellation.Fa()/Math.PI+")")};DefaultNodeRenderer.prototype.position=DefaultNodeRenderer.prototype.position;DefaultNodeRenderer.prototype.J=function(){jQuery(this.a.group).remove();this.a=s};DefaultNodeRenderer.prototype.destroy=DefaultNodeRenderer.prototype.J;DefaultNodeRenderer.prototype.M=function(){return this.a.group};
GephiNodeRenderer=function(a,b,c){NodeRenderer.call(this,a,b,c);this.label="";this.size=0};window.GephiNodeRenderer=GephiNodeRenderer;GephiNodeRenderer.prototype=new NodeRenderer;GephiNodeRenderer.prototype.defaultStyles={label:"",r:255,g:255,b:255,size:5};
GephiNodeRenderer.prototype.create=function(){var a=this.constellation.svg,b=a.group(this.constellation.Ca(),{display:"none"}),c=a.group(b);this.a={group:b,Ia:c,D:a.circle(c,0,0,this.size/2,{strokeWidth:3}),label:a.text(b,0,0,"",{style:"-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-o-user-select: none;user-select: none;",fontFamily:"Verdana",fontSize:12,fontWeight:"normal",fill:"#333333",textAnchor:"left",dy:".35em"})};jQuery(this.a.group).bind("mouseover",{context:this},
function(a){a.data.context.constellation.nodemouseoverHandler(a,a.data.context)}).bind("mouseout",{context:this},function(a){a.data.context.constellation.nodemouseoutHandler(a,a.data.context)}).bind("mousedown",{context:this},function(a){a.data.context.constellation.nodemousedownHandler(a,a.data.context)}).bind("mouseup",{context:this},function(a){a.data.context.constellation.nodemouseupHandler(a,a.data.context)}).bind("touchstart",{context:this},function(a){a.data.context.constellation.nodetouchstartHandler(a,
a.data.context)}).bind("touchend",{context:this},function(a){a.data.context.constellation.nodetouchendHandler(a,a.data.context)})};GephiNodeRenderer.prototype.create=GephiNodeRenderer.prototype.create;
GephiNodeRenderer.prototype.q=function(){var a=this.constellation.svg;jQuery(this.a.group).css("display","inline");var b={fill:"#"+(this.c("b")|this.c("g")<<8|this.c("r")<<16).toString(16),stroke:"#333333"},c=this.c("label"),d=this.c("size");this.size!=d?(b.r=d/2,a.change(this.a.D,b),a.change(this.a.label,{x:d/2+10})):a.change(this.a.D,b);this.label!=c&&jQuery(this.a.label).contents().remove().end().append(c);this.position();this.label=c;this.size=d};GephiNodeRenderer.prototype.draw=GephiNodeRenderer.prototype.q;
GephiNodeRenderer.prototype.position=function(){jQuery(this.a.group).attr("transform","translate("+this.x+","+this.y+")rotate("+180*-this.constellation.Fa()/Math.PI+")")};GephiNodeRenderer.prototype.position=GephiNodeRenderer.prototype.position;GephiNodeRenderer.prototype.J=function(){jQuery(this.a.group).remove();this.a=s};GephiNodeRenderer.prototype.destroy=GephiNodeRenderer.prototype.J;EdgeRenderer=function(a,b,c,d,e){this.constellation=a;this.classes=[];Edge.call(this,b,c,d,e);this.t()};
window.EdgeRenderer=EdgeRenderer;EdgeRenderer.prototype=new Edge;EdgeRenderer.prototype.defaultStyles={};EdgeRenderer.prototype.c=function(a){return this.constellation.c("edge",this.classes,a,this.data,this.defaultStyles)};EdgeRenderer.prototype.getStyle=EdgeRenderer.prototype.c;EdgeRenderer.prototype.addClass=function(a){0>jQuery.inArray(a,this.classes)&&this.classes.push(a)};EdgeRenderer.prototype.addClass=EdgeRenderer.prototype.addClass;
EdgeRenderer.prototype.hasClass=function(a){return 0<=jQuery.inArray(a,this.classes)};EdgeRenderer.prototype.hasClass=EdgeRenderer.prototype.hasClass;EdgeRenderer.prototype.removeClass=function(a){for(var b;0<=(b=jQuery.inArray(a,this.classes));)this.classes.splice(b,1)};EdgeRenderer.prototype.removeClass=EdgeRenderer.prototype.removeClass;EdgeRenderer.prototype.t=function(){Edge.prototype.t.call(this);if(this.data["class"]){this.classes=[];for(var a=this.data["class"].split(/\s/),b=0;b<a.length;b++)this.addClass(a[b])}};
EdgeRenderer.prototype.dataChanged=EdgeRenderer.prototype.t;EdgeRenderer.prototype.create=u();EdgeRenderer.prototype.create=EdgeRenderer.prototype.create;EdgeRenderer.prototype.q=u();EdgeRenderer.prototype.draw=EdgeRenderer.prototype.q;EdgeRenderer.prototype.position=u();EdgeRenderer.prototype.position=EdgeRenderer.prototype.position;EdgeRenderer.prototype.J=u();EdgeRenderer.prototype.destroy=EdgeRenderer.prototype.J;EdgeRenderer.prototype.M=u();EdgeRenderer.prototype.getSvg=EdgeRenderer.prototype.M;
DefaultEdgeRenderer=function(a,b,c,d,e){EdgeRenderer.call(this,a,b,c,d,e);this.L=s};window.DefaultEdgeRenderer=DefaultEdgeRenderer;DefaultEdgeRenderer.prototype=new EdgeRenderer;DefaultEdgeRenderer.prototype.defaultStyles={edgeLineColor:"#000000",edgeLineThickness:1,tooltip:"",cursor:"default",arrowhead:t,bidirectional:t,reverse:t};
DefaultEdgeRenderer.prototype.create=function(){var a=this.constellation.svg,b=a.group(this.constellation.$a(),{display:"inline"});this.a={group:b,line:a.line(b,0,0,0,0,{stroke:this.c("edgeLineColor"),strokeWidth:this.c("edgeLineThickness")}),l:s,m:s,L:a.title(b,"")};jQuery(this.a.group).bind("mouseover",{context:this},function(a){a.data.context.constellation.edgemouseoverHandler(a,a.data.context)}).bind("mouseout",{context:this},function(a){a.data.context.constellation.edgemouseoutHandler(a,a.data.context)}).bind("mousedown",
{context:this},function(a){a.data.context.constellation.edgemousedownHandler(a,a.data.context)}).bind("mouseup",{context:this},function(a){a.data.context.constellation.edgemouseupHandler(a,a.data.context)}).bind("touchstart",{context:this},function(a){a.data.context.constellation.edgetouchstartHandler(a,a.data.context)}).bind("touchend",{context:this},function(a){a.data.context.constellation.edgetouchendHandler(a,a.data.context)})};DefaultEdgeRenderer.prototype.create=DefaultEdgeRenderer.prototype.create;
DefaultEdgeRenderer.prototype.q=function(){var a=this.constellation.svg,b=this.c("edgeLineColor"),c=this.c("edgeLineThickness"),d=this.c("arrowhead"),e=this.c("reverse"),i=this.c("bidirectional"),g=this.tailNode.x,h=this.tailNode.y,j=this.headNode.x,o=this.headNode.y,k=j-g,m=o-h,l=Math.sqrt(k*k+m*m);if(g==s||h==s||j==s||o==s||0==l)jQuery(this.a.group).css("display","none"),this.a.l&&(jQuery(this.a.l).remove(),this.a.l=s),this.a.m&&(jQuery(this.a.m).remove(),this.a.m=s);else{var n=k/l,p=m/l,m=Math.atan2(m,
k),k=this.tailNode.getCenterToEdgeVector?this.tailNode.getCenterToEdgeVector(m):{x:0,y:0};k.length=Math.sqrt(k.x*k.x+k.y*k.y);m=this.headNode.getCenterToEdgeVector?this.headNode.getCenterToEdgeVector(m+Math.PI):{x:0,y:0};m.length=Math.sqrt(m.x*m.x+m.y*m.y);if(l<k.length+m.length)jQuery(this.a.group).css("display","none"),this.a.l&&(jQuery(this.a.l).remove(),this.a.l=s),this.a.m&&(jQuery(this.a.m).remove(),this.a.m=s);else{var l=l-k.length-m.length,l=Math.min(Math.max(15,6*c),0.4*l),r=0.4*l;d?(i||
!e?(j+=m.x-n*l,o+=m.y-p*l,this.a.l||(this.a.l=a.polygon(this.a.group,[[0,0]],{strokeWidth:0})),jQuery(this.a.l).attr("points",this.Ea([j-p*r/2,o+n*r/2],[j+n*l,o+p*l],[j+p*r/2,o-n*r/2])).css("fill",b)):this.a.l&&(jQuery(this.a.l).remove(),this.a.l=s),i||e?(g+=k.x+n*l,h+=k.y+p*l,this.a.m||(this.a.m=a.polygon(this.a.group,[[0,0]],{strokeWidth:0})),jQuery(this.a.m).attr("points",this.Ea([g-p*r/2,h+n*r/2],[g-n*l,h-p*l],[g+p*r/2,h-n*r/2])).css("fill",b)):this.a.m&&(jQuery(this.a.m).remove(),this.a.m=s)):
(this.a.l&&(jQuery(this.a.l).remove(),this.a.l=s),this.a.m&&(jQuery(this.a.m).remove(),this.a.m=s));jQuery(this.a.group).css("display","inline");jQuery(this.a.line).css("stroke",b).css("strokeWidth",c).css("cursor",this.c("cursor")).attr("x1",g).attr("y1",h).attr("x2",j).attr("y2",o)}}a=this.c("tooltip");this.L!=a&&jQuery(this.a.L).contents().remove().end().append(a);this.L=a};DefaultEdgeRenderer.prototype.draw=DefaultEdgeRenderer.prototype.q;DefaultEdgeRenderer.prototype.position=function(){this.q()};
DefaultEdgeRenderer.prototype.position=DefaultEdgeRenderer.prototype.position;DefaultEdgeRenderer.prototype.J=function(){jQuery(this.a.line).remove();this.a.l&&jQuery(this.a.l).remove();this.a.m&&jQuery(this.a.m).remove()};DefaultEdgeRenderer.prototype.destroy=DefaultEdgeRenderer.prototype.J;DefaultEdgeRenderer.prototype.M=function(){return this.a.group};
DefaultEdgeRenderer.prototype.Ea=function(){for(var a="";0<arguments.length;)var b=Array.prototype.shift.call(arguments),a=a+(" "+b[0]+","+b[1]);return a};DefaultEdgeRenderer.prototype.getPointsString=DefaultEdgeRenderer.prototype.Ea;Constellation=function(a,b){this.config=jQuery.extend(q,this.ob,a);this.ua=b?this.Ya.concat(b):this.Ya;this.f=[];this.e=[];this.xa=[];this.wa=[];this.svg=s;this.z=this.w=this.O=this.R=0;this.n=1;this.rotation=0;this.h={};this.V=this.u=this.s=this.d=s};
window.Constellation=Constellation;Constellation.Yb={};
Constellation.prototype.Jb=function(){this.debug("Initializing Constellation.");document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||f("Failed to initialize Constellation. SVG not supported.");var a=this.config.selector,b=jQuery(a);0>=b.length&&f("Failed to initialize Constellation. Container does not exist. selector="+a);b.html('<div style="position:relative;width:100%;height:100%"><div class="container" style="overflow:hidden;position:absolute;width:100%;height:100%;z-index:2"></div><div class="background" style="position:absolute;width:100%;height:100%;z-index:1"></div></div>');this.v=
b.find("div.container");this.v.svg({onLoad:function(a){return function(b){a.svg=b;a.debug("SVG initialized");z(a);a.Va=a.svg.group();a.za=a.svg.group(a.Va);a.qa=a.svg.group(a.Va);A(a)}}(this)});this.eb();this.lb(new Graph);a=this.config.graphLoaderClass;this.hb(a?new a(this.config.graphLoader):s);a=this.config.graphParserClass;this.ib(a?new a(this.config.graphParser):s);a=this.config.graphViewClass;this.jb(a?new a(this.config.graphView):s);a=this.config.layoutClass;this.kb(a?new a(this.config.layout):
s);"createTouch"in document?(this.v.find("svg").bind("touchstart",{context:this},function(a){var b=a.data.context;a.stopPropagation();a.preventDefault();for(var e=0;e<a.originalEvent.changedTouches.length;e++){var i=a.originalEvent.changedTouches[e],g=b.h["_"+i.identifier]={ca:q,i:i,pageX:i.pageX,pageY:i.pageY,timestamp:(new Date).getTime()},h=b.F(i.pageX),i=b.G(0,i.pageY);g.x=b.P(h,i);g.y=b.Q(h,i);b.d?b.s||(b.s=g):b.d=g}jQuery(b).trigger("touchstart")}).bind("touchmove",{context:this},function(a){var b=
a.data.context;a.stopPropagation();a.preventDefault();C(b);jQuery(b).trigger("touchmove")}),jQuery(document).bind("touchend",{context:this},function(a){a.data.context.Pa(a)}).bind("touchcancel",{context:this},function(a){var b=a.data.context;a.preventDefault();for(var e=0;e<a.originalEvent.changedTouches.length;e++)delete b.h["_"+a.originalEvent.changedTouches[e].identifier];jQuery(b).trigger("touchcancel")})):(this.v.find("svg").mousedown({context:this},function(a){var b=a.data.context,e=b.h._mouse=
{ca:t,i:a,pageX:a.pageX,pageY:a.pageY},i=b.F(a.pageX),a=b.G(0,a.pageY);e.x=b.P(i,a);e.y=b.Q(i,a);b.d?b.s||(b.s=e):b.d=e;jQuery(b).trigger("mousedown")}).click({context:this},function(a){a.stopPropagation();a.preventDefault()}).bind("mousewheel",{context:this},function(a,b){var e=a.data.context;a.preventDefault();var i=e.config.zoomSlider;isNaN||e.W(Math.max(i.min,Math.min(i.max,e.pa()+0.05*b)));jQuery(e).trigger("mousewheel")}),jQuery(document).mousemove({context:this},function(a){var b=a.data.context,
e=b.h._mouse;e&&(e.i=a);C(b)}).mouseup({context:this},function(a){a.data.context.fa(a,q)}));z(this);jQuery(this).trigger("initialized")};Constellation.prototype.init=Constellation.prototype.Jb;
Constellation.prototype.eb=function(){var a=this.config.zoomSlider;if(!this.v.button||!this.v.slider)this.warn("Missing jQuery UI so skipping zoom controls initialization.");else{this.v.append('<div class="zoomControls"><button class="zoomInButton">Zoom in</button><div class="zoomSlider"></div><button class="zoomOutButton">Zoom out</button></div>');var b=this.config.selector;jQuery("head").append('<style type="text/css">'+b+" .zoomControls { position: absolute; right: 20px; top: 20px; width: 20px; z-index: 1 } "+
b+" .zoomControls .ui-button { height: 20px; margin: 1px 0; width: 20px } "+b+" .zoomSlider { left: 3px; height: 225px; margin: 11px 0 } </style>");jQuery(b+" .zoomInButton").button({icons:{primary:"ui-icon-plus"},text:t}).bind("click",{context:this},function(b){b=b.data.context;b.W(Math.min(a.max,b.pa()+a.step))});jQuery(b+" .zoomOutButton").button({icons:{primary:"ui-icon-minus"},text:t}).bind("click",{context:this},function(b){b=b.data.context;b.W(Math.max(a.min,b.pa()-a.step))});jQuery(b+" .zoomSlider").slider(a).bind("slide",
{context:this},function(a,b){a.data.context.W(b.value)});switch(a.display){case "on":case "yes":case "true":case q:case 1:break;case "auto":"createTouch"in document&&jQuery(b+" .zoomControls").hide();break;default:jQuery(b+" .zoomControls").hide()}}this.W(a.value)};Constellation.prototype.initZoomControls=Constellation.prototype.eb;
Constellation.prototype.ob={selector:"#constellation",graphLoaderClass:SimpleGraphLoader,graphLoader:{},graphParserClass:JsonGraphParser,graphParser:{},graphViewClass:DirectGraphView,graphView:{},layoutClass:RoamerLayout,layout:{},zoomSlider:{display:"auto",orientation:"vertical",min:0.2,max:2,value:1,step:0.05}};Constellation.prototype.Ya=[["node",{rendererClass:DefaultNodeRenderer}],["edge",{rendererClass:DefaultEdgeRenderer}]];Constellation.prototype.Bb=w("ea");
Constellation.prototype.getModel=Constellation.prototype.Bb;Constellation.prototype.lb=function(a){this.debug("Set model:",a);this.ea=a;this.C&&this.C.setGraph(this.ea);this.o&&this.o.setSource(this.ea);this.La()};Constellation.prototype.setModel=Constellation.prototype.lb;Constellation.prototype.zb=w("o");Constellation.prototype.getGraphView=Constellation.prototype.zb;
Constellation.prototype.jb=function(a){this.debug("Set graph view:",a);this.o&&(this.o.setConstellation(s),this.o.setSource(s),this.o.setResult(s),jQuery(this.o).unbind("change"));if(this.o=a)this.o.setConstellation(this),this.o.setSource(this.ea),this.o.setResult(this),jQuery(this.o).bind("change",{context:this},function(a){a.data.context.N()})};Constellation.prototype.setGraphView=Constellation.prototype.jb;Constellation.prototype.xb=w("B");Constellation.prototype.getGraphLoader=Constellation.prototype.xb;
Constellation.prototype.hb=function(a){this.debug("Set graph loader:",a);this.B&&(this.B.setConstellation(s),this.B.setParser(s));if(this.B=a)this.B.setConstellation(this),this.B.setParser(this.C)};Constellation.prototype.setGraphLoader=Constellation.prototype.hb;Constellation.prototype.yb=w("C");Constellation.prototype.getGraphParser=Constellation.prototype.yb;
Constellation.prototype.ib=function(a){this.debug("Set graph parser:",a);this.C&&(this.B&&this.B.setParser(s),this.C.setGraph(s),jQuery(this.C).unbind("complete"));if(this.C=a)this.B&&this.B.setParser(this.C),this.C.setGraph(this.ea),jQuery(this.C).bind("complete",{context:this},function(a){a.data.context.La()})};Constellation.prototype.setGraphParser=Constellation.prototype.ib;Constellation.prototype.Ab=w("K");Constellation.prototype.getLayout=Constellation.prototype.Ab;
Constellation.prototype.kb=function(a){this.debug("Set layout:",a);this.K&&(this.K.setConstellation(s),jQuery(this.K).unbind("change"));if(this.K=a)this.K.setConstellation(this),jQuery(this.K).bind("change",{context:this},function(a){a.data.context.fb()})};Constellation.prototype.setLayout=Constellation.prototype.kb;Constellation.prototype.Ca=w("qa");Constellation.prototype.getNodeContainer=Constellation.prototype.Ca;Constellation.prototype.$a=w("za");Constellation.prototype.getEdgeContainer=Constellation.prototype.$a;
Constellation.prototype.Ga=w("u");Constellation.prototype.getSelectedNodeId=Constellation.prototype.Ga;Constellation.prototype.Vb=function(a){this.debug("Set selected node ID:",a);this.V&&(this.V=s,jQuery(this).trigger("edgeselect"));this.u!=a&&(this.u=a,jQuery(this).trigger("nodeselect",this.u))};Constellation.prototype.setSelectedNodeId=Constellation.prototype.Vb;Constellation.prototype.Gb=w("V");Constellation.prototype.getSelectedEdgeId=Constellation.prototype.Gb;
Constellation.prototype.Ub=function(a){this.u&&(this.u=s,jQuery(this).trigger("nodeselect"));this.V!=a&&(this.V=a,jQuery(this).trigger("edgeselect",this.V))};Constellation.prototype.setSelectedEdgeId=Constellation.prototype.Ub;Constellation.prototype.ab=function(){return this.qa.getBBox()};Constellation.prototype.getRendererBounds=Constellation.prototype.ab;
Constellation.prototype.I=function(a,b){this.debug("Add node:",a);this.k(a)&&f("Failed to add node. Node already exists. id="+a);var c=new (this.c("node",b&&b["class"]?b["class"].split(/\s/):[],"rendererClass",b,{rendererClass:DefaultNodeRenderer}))(this,a,b);c.create();this.f.push(c);this.xa.push(c);jQuery(this).trigger("nodeAdded",c);return c};Constellation.prototype.addNode=Constellation.prototype.I;
Constellation.prototype.k=function(a){for(var b=0;b<this.f.length;b++)if(this.f[b].id==a)return this.f[b];return s};Constellation.prototype.getNode=Constellation.prototype.k;Constellation.prototype.S=function(){return this.f.concat()};Constellation.prototype.getNodes=Constellation.prototype.S;Constellation.prototype.ba=function(){return this.f.map(function(a){return a.id})};Constellation.prototype.getNodeIds=Constellation.prototype.ba;Constellation.prototype.Da=function(){return this.f.length};
Constellation.prototype.getNodeLength=Constellation.prototype.Da;Constellation.prototype.removeNode=function(a){this.debug("Remove node:",a);for(var b=0;b<this.f.length;b++){var c=this.f[b];if(c.id==a){for(;0<c.edges.length;)this.U(c.edges[0].id);c.destroy(c);this.f.splice(b,1);jQuery(this).trigger("nodeRemoved",c);return}}f("Failed to remove node. Node does not exist. id="+a)};Constellation.prototype.removeNode=Constellation.prototype.removeNode;
Constellation.prototype.Ra=function(a,b){var c=this.k(a);c?c.data=b:f("Failed to update node. Node does not exist. id="+a);return c};Constellation.prototype.updateNode=Constellation.prototype.Ra;Constellation.prototype.Ta=function(a,b,c,d){var c=2<arguments.length?c:t,d=3<arguments.length?d:t,e=this.k(a);e?e.data=c?jQuery.extend(d,e.data,b):b:e=this.I(a,b);return e};Constellation.prototype.upsertNode=Constellation.prototype.Ta;
Constellation.prototype.H=function(a,b,c,d){this.debug("Add edge:",a);this.A(a)&&f("Failed to add edge. Edge already exists. edge_id="+a);var e=this.k(b);e||f("Failed to add edge. Tail node does not exist. edge_id="+a+", tail_node_id="+b);(b=this.k(c))||f("Failed to add edge. Head node does not exist. edge_id="+a+", head_node_id="+c);a=new (this.c("edge",d&&d["class"]?d["class"].split(/\s/):[],"rendererClass",d,{rendererClass:DefaultNodeRenderer}))(this,a,e,b,d);a.create();this.e.push(a);this.wa.push(a);
e.edges.push(a);b.edges.push(a);jQuery(this).trigger("edgeAdded",a);return a};Constellation.prototype.addEdge=Constellation.prototype.H;Constellation.prototype.A=function(a){for(var b=0;b<this.e.length;b++)if(this.e[b].id==a)return this.e[b];return s};Constellation.prototype.getEdge=Constellation.prototype.A;Constellation.prototype.aa=function(){return this.e.map(function(a){return a.id})};Constellation.prototype.getEdgeIds=Constellation.prototype.aa;Constellation.prototype.oa=function(){return this.e.concat()};
Constellation.prototype.getEdges=Constellation.prototype.oa;Constellation.prototype.Aa=function(){return this.e.length};Constellation.prototype.getEdgeLength=Constellation.prototype.Aa;
Constellation.prototype.U=function(a){this.debug("Remove edge:",a);var b,c=s;for(b=0;b<this.e.length;b++)if(this.e[b].id==a){c=this.e[b];c.destroy();this.e.splice(b,1);break}if(c){for(b=0;b<c.tailNode.edges.length;b++)if(c.tailNode.edges[b].id==a){c.tailNode.edges.splice(b,1);break}for(b=0;b<c.headNode.edges.length;b++)if(c.headNode.edges[b].id==a){c.headNode.edges.splice(b,1);break}jQuery(this).trigger("edgeRemoved",c)}else f("Failed to remove edge. Edge does not exist. id="+a)};
Constellation.prototype.removeEdge=Constellation.prototype.U;Constellation.prototype.Qa=function(a,b){var c=this.A(a);c?c.data=b:f("Failed to update edge. Edge does not exist. id="+a);return c};Constellation.prototype.updateEdge=Constellation.prototype.Qa;Constellation.prototype.Sa=function(a,b,c,d,e,i){var e=4<arguments.length?e:t,i=5<arguments.length?i:t,g=this.A(a);g?g.data=e?jQuery.extend(i,g.data,d):d:g=this.H(a,b,c,d);return g};Constellation.prototype.upsertEdge=Constellation.prototype.Sa;
Constellation.prototype.La=function(){this.debug("Model changed");this.o&&this.o.mb();jQuery(this).trigger("modelchanged")};Constellation.prototype.modelChanged=Constellation.prototype.La;Constellation.prototype.N=function(){this.debug("View changed");this.K&&this.K.viewChanged();jQuery(this).trigger("viewchanged")};Constellation.prototype.viewChanged=Constellation.prototype.N;Constellation.prototype.fb=function(){this.q()};Constellation.prototype.layoutChanged=Constellation.prototype.fb;
Constellation.prototype.q=function(){var a,b;for(z(this);0<this.xa.length;)b=this.xa.pop(),b.draw();for(;0<this.wa.length;)b=this.wa.pop(),b.draw();var c=this.f;for(a=0;a<c.length;a++)b=c[a],b.position();c=this.e;for(a=0;a<c.length;a++)b=c[a],b.position()};function z(a){a.R=a.v.width();a.O=a.v.height();A(a);jQuery(a).trigger("viewportchange")}
function A(a){a.v.button&&a.v.slider&&jQuery(a.config.selector+" .zoomSlider").slider("option","value",a.n);jQuery(a.Va).attr("transform","translate("+(a.R/2-a.w)+","+(a.O/2-a.z)+")scale("+a.n+","+a.n+")rotate("+180*a.rotation/Math.PI+")")}Constellation.prototype.pa=w("n");Constellation.prototype.getZoomScale=Constellation.prototype.pa;Constellation.prototype.W=function(a){this.n=a;A(this);jQuery(this).trigger("viewportchange")};Constellation.prototype.setZoomScale=Constellation.prototype.W;
Constellation.prototype.Fa=w("rotation");Constellation.prototype.getRotation=Constellation.prototype.Fa;Constellation.prototype.Tb=function(a){this.rotation=a;A(this);jQuery(this).trigger("viewportchange")};Constellation.prototype.setRotation=Constellation.prototype.Tb;Constellation.prototype.P=function(a,b){return(a-this.R/2+this.w)/this.n*Math.cos(-this.rotation)-(b-this.O/2+this.z)/this.n*Math.sin(-this.rotation)};Constellation.prototype.viewportToWorldX=Constellation.prototype.P;
Constellation.prototype.Q=function(a,b){return(a-this.R/2+this.w)/this.n*Math.sin(-this.rotation)+(b-this.O/2+this.z)/this.n*Math.cos(-this.rotation)};Constellation.prototype.viewportToWorldY=Constellation.prototype.Q;Constellation.prototype.Y=function(a,b){return(a*Math.cos(this.rotation)-b*Math.sin(this.rotation))*this.n+this.R/2-this.w};Constellation.prototype.worldToViewportX=Constellation.prototype.Y;
Constellation.prototype.Z=function(a,b){return(a*Math.sin(this.rotation)+b*Math.cos(this.rotation))*this.n+this.O/2-this.z};Constellation.prototype.worldToViewportY=Constellation.prototype.Z;Constellation.prototype.F=function(a){return a-this.v.offset().left};Constellation.prototype.pageToViewportX=Constellation.prototype.F;Constellation.prototype.G=function(a,b){return b-this.v.offset().top};Constellation.prototype.pageToViewportY=Constellation.prototype.G;
Constellation.prototype.Ha=function(){var a={x:this.P(0,0),y:this.Q(0,0)};a.width=this.P(this.R,this.O)-a.x;a.height=this.Q(this.R,this.O)-a.y;return a};Constellation.prototype.getViewportBounds=Constellation.prototype.Ha;Constellation.prototype.Lb=function(a,b){a.stopPropagation();a.preventDefault();this.ma(b);jQuery(this).trigger("nodemouseover",b.id)};Constellation.prototype.nodemouseoverHandler=Constellation.prototype.Lb;
Constellation.prototype.Kb=function(a,b){a.stopPropagation();a.preventDefault();jQuery(this).trigger("nodemouseout",b.id)};Constellation.prototype.nodemouseoutHandler=Constellation.prototype.Kb;Constellation.prototype.ha=function(a,b){a.stopPropagation();a.preventDefault();this.ma(b);var c=this.h._mouse={ca:t,ga:b,i:a,pageX:a.pageX,pageY:a.pageY,timestamp:(new Date).getTime()},d=this.F(a.pageX),e=this.G(0,a.pageY);c.Ma=this.P(d,e)-b.x;c.Na=this.Q(d,e)-b.y;jQuery(this).trigger("nodemousedown",b.id)};
Constellation.prototype.nodemousedownHandler=Constellation.prototype.ha;Constellation.prototype.Mb=function(a,b){a.stopPropagation();a.preventDefault();var c=this.h._mouse;c&&H(a,c)&&jQuery(this).trigger("nodeclick",b.id);this.fa(a,t);jQuery(this).trigger("nodemouseup",b.id)};Constellation.prototype.nodemouseupHandler=Constellation.prototype.Mb;
Constellation.prototype.ia=function(a,b){a.stopPropagation();a.preventDefault();this.ma(b);for(var c=0;c<a.originalEvent.changedTouches.length;c++){var d=a.originalEvent.changedTouches[c];this.h["_"+d.identifier]={ca:q,ga:b,Ma:this.F(d.pageX)-this.Y(b.x,b.y),Na:this.G(0,d.pageY)-this.Z(b.x,b.y),i:d,pageX:d.pageX,pageY:d.pageY,timestamp:(new Date).getTime()}}jQuery(this).trigger("nodetouchstart",b.id)};Constellation.prototype.nodetouchstartHandler=Constellation.prototype.ia;
Constellation.prototype.Nb=function(a,b){a.stopPropagation();a.preventDefault();for(var c=0;c<a.originalEvent.changedTouches.length;c++){var d=a.originalEvent.changedTouches[c],e=this.h["_"+d.identifier];e&&H(d,e)&&jQuery(this).trigger("nodeclick",b.id);delete this.h["_"+d.identifier]}jQuery(this).trigger("nodetouchend",b.id)};Constellation.prototype.nodetouchendHandler=Constellation.prototype.Nb;
Constellation.prototype.sb=function(a,b){a.stopPropagation();a.preventDefault();jQuery(this).trigger("edgemouseover",b.id)};Constellation.prototype.edgemouseoverHandler=Constellation.prototype.sb;Constellation.prototype.rb=function(a,b){a.stopPropagation();a.preventDefault();jQuery(this).trigger("edgemouseout",b.id)};Constellation.prototype.edgemouseoutHandler=Constellation.prototype.rb;
Constellation.prototype.qb=function(a,b){a.stopPropagation();a.preventDefault();this.h._mouse={pb:b,ca:t,i:a,pageX:a.pageX,pageY:a.pageY};jQuery(this).trigger("edgemousedown",b.id)};Constellation.prototype.edgemousedownHandler=Constellation.prototype.qb;Constellation.prototype.tb=function(a,b){a.stopPropagation();a.preventDefault();var c=this.h._mouse;c&&H(a,c)&&jQuery(this).trigger("edgeclick",b.id);this.fa(a,t);jQuery(this).trigger("edgemouseup",b.id)};
Constellation.prototype.edgemouseupHandler=Constellation.prototype.tb;Constellation.prototype.vb=function(a,b){a.stopPropagation();a.preventDefault();for(var c=0;c<a.originalEvent.changedTouches.length;c++){var d=a.originalEvent.changedTouches[c];this.h["_"+d.identifier]={pb:b,ca:q,i:d,pageX:d.pageX,pageY:d.pageY,timestamp:(new Date).getTime()}}jQuery(this).trigger("edgetouchstart",b.id)};Constellation.prototype.edgetouchstartHandler=Constellation.prototype.vb;
Constellation.prototype.ub=function(a,b){a.stopPropagation();a.preventDefault();for(var c=0;c<a.originalEvent.changedTouches.length;c++)delete this.h["_"+a.originalEvent.changedTouches[c].identifier];jQuery(this).trigger("edgetouchend",b.id)};Constellation.prototype.edgetouchendHandler=Constellation.prototype.ub;
Constellation.prototype.fa=function(a,b){var c=this.h._mouse;c&&(c.i=a);b&&(c&&H(a,c)&&jQuery(this).trigger("click"),C(this));delete this.h._mouse;this.d==c&&(this.d=this.s,this.s=s);this.s==c&&(this.s=s);b&&jQuery(this).trigger("mouseup")};
Constellation.prototype.Pa=function(a){a.preventDefault();C(this);for(var b=0;b<a.originalEvent.changedTouches.length;b++)var c=a.originalEvent.changedTouches[b],d=this.h["_"+c.identifier];for(b=0;b<a.originalEvent.changedTouches.length;b++)c=a.originalEvent.changedTouches[b],d=this.h["_"+c.identifier],delete this.h["_"+c.identifier],this.d==d&&(this.d=this.s,this.s=s,this.d&&(this.d.pageX=this.d.i.pageX,this.d.pageY=this.d.i.pageY,this.d.w=this.w,this.d.z=this.z,this.d.n=this.n)),this.s==d&&(this.s=
s,this.d&&(this.d.pageX=this.d.i.pageX,this.d.pageY=this.d.i.pageY,this.d.w=this.w,this.d.z=this.z,this.d.n=this.n));jQuery(this).trigger("touchend")};
function C(a){var b=a.d,c=a.s;if(b){if(c){var d=a.Y(c.x,c.y)-a.Y(b.x,b.y),e=a.Z(c.x,c.y)-a.Z(b.x,b.y),i=Math.sqrt(d*d+e*e),g=a.F(c.i.pageX)-a.F(b.i.pageX),h=a.G(0,c.i.pageY)-a.G(0,b.i.pageY),c=Math.sqrt(g*g+h*h),d=Math.atan2(h,g)-Math.atan2(e,d);d>Math.PI&&(d-=2*Math.PI);d<-Math.PI&&(d=2*Math.PI+d);a.n=a.n*c/i;a.rotation+=d;a.w=a.w+a.Y(b.x,b.y)-a.F(b.i.pageX);a.z=a.z+a.Z(b.x,b.y)-a.G(0,b.i.pageY);0!=d&&a.q()}else a.w=a.w+a.Y(b.x,b.y)-a.F(b.i.pageX),a.z=a.z+a.Z(b.x,b.y)-a.G(0,b.i.pageY);A(a);jQuery(a).trigger("viewportchange")}}
Constellation.prototype.c=function(a,b,c,d,e){var i,g;if(d&&void 0!==d[c])return d[c];if(b&&0<b.length)for(d=this.ua.length;0<d;d--){g=this.ua[d-1];i=g[0];var h=jQuery.inArray(".",i),j=0>h?i:i.substr(0,h);if(!(""!=j&&j!=a)){h=0>h?[]:i.substr(h+1).split(".");j=q;for(i=0;i<h.length;i++)if(0>jQuery.inArray(h[i],b)){j=t;break}if(j&&void 0!==g[1][c])return g[1][c]}}for(d=this.ua.length;0<d;d--)if((g=this.ua[d-1])&&1<g.length&&g[0]==a&&void 0!==g[1][c])return g[1][c];return e?e[c]:void 0};
Constellation.prototype.getStyle=Constellation.prototype.c;Constellation.prototype.ma=function(a){var b=jQuery(this.qa).children().last()[0],a=a.M();b!=a&&jQuery(a).insertAfter(jQuery(this.qa).children().last())};Constellation.prototype.arrangeNodeFront=Constellation.prototype.ma;Constellation.prototype.nb=function(a){jQuery(this.za).children().last()[0]!=a.renderer.group&&jQuery(a.renderer.group).insertAfter(jQuery(this.za).children().last())};Constellation.prototype.arrangeEdgeFront=Constellation.prototype.nb;
function H(a,b){var c=a.pageX-b.pageX,d=a.pageY-b.pageY;return 5>Math.sqrt(c*c+d*d)}Constellation.prototype.debug=function(a){jQuery(this).trigger("log",["debug"].concat(Array.prototype.slice.call(arguments)))};Constellation.prototype.debug=Constellation.prototype.debug;Constellation.prototype.warn=function(a){jQuery(this).trigger("log",["warn"].concat(Array.prototype.slice.call(arguments)))};Constellation.prototype.warn=Constellation.prototype.warn;
Constellation.prototype.error=function(a){jQuery(this).trigger("log",["error"].concat(Array.prototype.slice.call(arguments)))};Constellation.prototype.error=Constellation.prototype.error;
